<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cadastro</title>
  <link rel="stylesheet" href="css/cadastro.css">
</head>

<body>

  <!-- NAVBAR -->
  <div class="Navbar">
    <!-- <div class="logoSite"></div> -->

    <div class="botoes1">
      <a href="index.html" style="text-decoration: none;">
        <label class="inicio" style="color: #F5FF0C;">Início</label>
      </a>

      <a href="quiz.html" style="text-decoration: none;">
        <label class="quiz" style="color: orange;">Quiz</label>
      </a>


    </div>

    <div class="loginCadastro">
      <label style="color: orange;">
        <a href="login.html" style="text-decoration: none;">Login</a>
      </label>

      <label style="color: orange;">
        <a href="cadastro.html" style="text-decoration: none;">Cadastro</a>
      </label>
    </div>

  </div>
  <!-- CONTEÚDO -->
  <main class="container">

    <!-- <div class="logo-central">logo</div> -->

    <div class="caixa-cadastro">

  

        <div class="linha">
          <div class="campo">
            <label>E-mail</label>
            <input type="text" id="ipt_email">
          </div>

          <div class="campo">
            <label>Nome de usuário</label>
            <input type="text" id="ipt_nomeUser">
          </div>
        </div>

        <div class="linha">
          <div class="campo">
            <label>Senha</label>
            <input type="password" id="ipt_senha">
          </div>

          <div class="campo">
            <label>Confirmar Senha</label>
            <input type="password" id="ipt_senhaCerta">
          </div>
        </div>

        <img src="imagens/determinacao.png" class="coracao">

        <button  class="btn-start" onclick="cadastrar()">START</button>

        <p class="registro">
          Já possui conta? <a href="login.html">Faça Login</a>
        </p>


    </div>

  </main>

</body>

</html>


<script>

  // Array para armazenar empresas cadastradas para validação de código de ativação 
  let listaCadastroSite = [];

  function cadastrar() {
    // aguardar();

    //Recupere o valor da nova input pelo nome do id
    // Agora vá para o método fetch logo abaixo
    var nomeUser = ipt_nomeUser.value;

    var email = ipt_email.value;

    var senha = ipt_senha.value;

    var senhaCerta = ipt_senhaCerta.value;

    var idCadastroLogin


    // Verificando se há algum campo em branco
    // if (
    //   nomeUser == "" ||
    //   email == "" ||
    //   senha == "" ||
    //   senhaCerta == ""
    // ) 


    // Enviando o valor da nova input
    fetch("/usuarios/cadastrar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        // crie um atributo que recebe o valor recuperado aqui
        // Agora vá para o arquivo routes/usuario.js
        nomeServer: nomeUser,
        emailServer: email,
        senhaServer: senha,
      }),
    })

    .then(async function (resposta) {
    console.log("Status da resposta:", resposta.status);

    const texto = await resposta.text();
    console.log("Corpo da resposta:", texto);

    if (resposta.ok) {
        console.log("REDIRECIONANDO...");
        window.location.href = "login.html";
    } else {
        console.error("RESPOSTA NÃO OK");
    }
})
.catch(function (erro) {
    console.error("ERRO NO FETCH:", erro);
});





      // .then(async function (resposta) {
      //   console.log("Status:", resposta.status);

      //   const texto = await resposta.text();
      //   console.log("Resposta do servidor:", texto);

      //   if (resposta.ok) {

      //     alert('Cadastro Realizado com sucesso! redirecionando para a pagina de login...');

      //     setTimeout(() => {
      //       window.location = "./login.html";
      //     }, "2000");


      //   } else {
      //     throw "Houve um erro ao tentar realizar o cadastro!";
      //   }
      // })
      // .catch(function (resposta) {
      //   console.log("#ERRO:${resposta}", erro);

      // });

  }



</script>